# BioinfoFlow Specification v0.1 ğŸ§¬

## Table of Contents
- [Overview](#overview) ğŸ“‹
- [Key Features](#key-features) â­
- [Core Concepts](#core-concepts) ğŸ’¡
- [File Format](#file-format) ğŸ“„
- [Configuration Reference](#configuration-reference) âš™ï¸
- [Examples](#examples) ğŸŒŸ
- [Best Practices](#best-practices) ğŸ¯
- [Experimental Features](#experimental-features) ğŸ§ª
- [Style Guide](#style-guide) ğŸ“
- [Version Control](#version-control) ğŸ”„

## Overview ğŸ“‹

BioinfoFlow is a powerful workflow engine specifically designed for bioinformatics applications. This specification defines a human-readable, container-native workflow language that emphasizes reproducibility, scalability, and ease of use.

## Key Features â­

- ğŸ³ Container-native execution with automatic version management
- ğŸ“Š Flexible resource management
- ğŸ’¾ Built-in checkpoint and resume capability
- ğŸ” Dynamic input pattern matching
- âš¡ Parallel and sequential execution support
- ğŸ”— Clear dependency management
- ğŸ›¡ï¸ Environment isolation

## Core Concepts ğŸ’¡

### Workflows
A workflow is a collection of steps that process data. Each step represents a discrete unit of work.

### Steps
Steps are the basic building blocks of a workflow. They can be:
- Single tasks
- Parallel groups
- Sequential groups

### Dependencies
Steps can depend on other steps, forming a directed acyclic graph (DAG).

### Containers
Each step runs in its own container environment, ensuring reproducibility.

## File Format ğŸ“„

Workflows are defined in YAML format. Here's the basic structure:

```yaml
name: my_workflow           # Simple identifier, no quotes needed
version: "1.0.0"           # Version number, quotes required
description: A simple workflow for DNA analysis

inputs:
  fastq_files:
    type: file
    pattern: "*.fastq.gz"  # Pattern with special chars, quotes required
    
steps:
  fastqc:
    container: "biocontainers/fastqc:v0.11.9"  # Image reference, quotes required
    command: "fastqc ${inputs.fastq_files}"     # Command with vars, quotes required
    resources:
      cpu: 2               # Numbers, no quotes
      memory: 4G           # Units, no quotes
```

## Configuration Reference âš™ï¸

### Root Level Fields

| Field | Type | Required | Description |
|-------|------|----------|-------------|
| name | string | Yes | Workflow name |
| version | string | Yes | Workflow version |
| description | string | No | Workflow description |
| inputs | object | No | Global inputs |
| steps | object | Yes | Workflow steps |
| resources | object | No | Resource defaults |

### Step Configuration

```yaml
steps:
  step_name:
    container: "image:tag"        # Container image
    command: "echo hello"         # Command to run
    after: [step1, step2]        # Dependencies
    parallel: true               # Parallel execution flag
    resources:
      cpu: 2
      memory: 4G
    volumes:
      - "/host:/container"       # Volume mounts
```

### Resource Configuration

```yaml
resources:
    cpu: 1
    memory: 4G
    gpu: 0
```

## Examples ğŸŒŸ

### Simple DNA-seq Pipeline

```yaml
name: dna_seq_pipeline
version: "1.0.0"

inputs:
  reads:
    type: file
    pattern: "*.fastq.gz"

steps:
  fastqc:
    container: "biocontainers/fastqc:v0.11.9"
    command: "fastqc ${inputs.reads}"
    resources:
      cpu: 2
      memory: 4G

  bwa_mem:
    container: "biocontainers/bwa:v0.7.17"
    command: "bwa mem -t ${resources.cpu} ref.fa ${inputs.reads}"
    after: [fastqc]
    resources:
      cpu: 8
      memory: 16G
```

## Best Practices ğŸ¯

### Container Usage ğŸ³
- Use specific version tags
- Minimize image size
- Use official or verified images

### Resource Management ğŸ“Š
- Set appropriate resource limits
- Use resource profiles for different environments
- Monitor resource usage

### Workflow Design ğŸ“
- Keep steps modular
- Use meaningful names
- Document inputs and outputs

### Error Handling âš ï¸
- Implement proper error checking
- Use appropriate retry strategies
- Log errors effectively

## Experimental Features ğŸ§ª

### Metadata
```yaml
metadata:
  author: name
  tags: [DNA-seq, RNA-seq]
  license: MIT
  documentation: "https://docs.example.com"
```

### Conditions
```yaml
conditions:
  file_exists:
    when: "exists:/path/to/file"
    skip: false
```

### Hooks
```yaml
hooks:
  before_step:
    - "check_resources"
  after_step:
    - "cleanup"
```

## Style Guide ğŸ“

### Quoting Rules

Use quotes for:
- ğŸ“ File paths: `"path/to/file"`
- ğŸ“Œ Version numbers: `"1.0.0"`
- ğŸ”¤ Strings with special characters
- ğŸ’» Commands with variables
- ğŸ³ Container references

Don't use quotes for:
- ğŸ“› Simple identifiers
- ğŸ”¢ Numbers
- âš¡ Resource units
- âœ… Boolean values

## Version Control ğŸ”„

This specification is version 0.1. Future versions may include:
- ğŸ”„ Advanced container orchestration
- ğŸ”— Enhanced dependency management
- ğŸ›¡ï¸ Extended security features
- ğŸ“Š Advanced monitoring capabilities 